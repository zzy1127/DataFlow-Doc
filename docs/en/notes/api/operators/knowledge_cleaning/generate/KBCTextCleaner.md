---
title: KBCTextCleaner
createTime: 2025/10/09 16:52:48
permalink: /en/api/operators/knowledge_cleaning/generate/kbctextcleaner/
---

## ğŸ“˜ Overview

`KBCTextCleaner` is a **knowledge-cleaning operator** designed to standardize raw knowledge content by removing HTML tags, normalizing special characters, handling hyperlinks, and optimizing text structure.
Its goal is to improve the **quality and reliability** of RAG (Retrieval-Augmented Generation) knowledge bases.

---

## **init** Function

```python
def __init__(self, llm_serving: LLMServingABC, lang="en", prompt_template = KnowledgeCleanerPrompt)
```

### Initialization Parameters

| Parameter           | Type          | Default                    | Description                                                                                     |
| :------------------ | :------------ | :------------------------- | :---------------------------------------------------------------------------------------------- |
| **llm_serving**     | LLMServingABC | Required                   | The LLM service instance used for inference and text generation.                                |
| **lang**            | str           | "en"                       | Language setting for selecting the prompt template. Supports `'zh'` and `'en'`.                 |
| **prompt_template** | PromptABC     | `KnowledgeCleanerPrompt()` | The prompt template object. If not provided, the default `KnowledgeCleanerPrompt` will be used. |

---

### Prompt Template Description

| Prompt Template            | Purpose                         | Application Scenario            | Key Features                                                    |
| -------------------------- | ------------------------------- | ------------------------------- | --------------------------------------------------------------- |
| **KnowledgeCleanerPrompt** | Multi-dimensional text cleaning | Private knowledge base cleaning | Removes sensitive information and noise, performs normalization |

---

## run Function

```python
def run(self, storage: DataFlowStorage, input_key: str = "raw_chunk", output_key: str = "cleaned_chunk")
```

Executes the main logic of the operator â€” it reads the input DataFrame from the storage, generates cleaned text, and writes the result back to storage.

### Parameters

| Name           | Type            | Default         | Description                                                            |
| :------------- | :-------------- | :-------------- | :--------------------------------------------------------------------- |
| **storage**    | DataFlowStorage | Required        | DataFlow storage instance responsible for reading and writing data.    |
| **input_key**  | str             | "raw_chunk"     | Input column name corresponding to the raw knowledge chunk field.      |
| **output_key** | str             | "cleaned_chunk" | Output column name corresponding to the cleaned knowledge chunk field. |

---

## ğŸ§  Example Usage

```python
self.knowledge_cleaning_step3 = KBCTextCleaner(
    llm_serving=self.llm_serving,
    lang="en"
)
self.knowledge_cleaning_step3.run(
    storage=self.storage.step(),
    # input_key=,
    # output_key=,
)
```

---

## ğŸ§¾ Default Output Format

| Field             | Type | Description                                               |
| :---------------- | :--- | :-------------------------------------------------------- |
| **raw_chunk**     | str  | The input raw knowledge text.                             |
| **cleaned_chunk** | str  | The cleaned and standardized text generated by the model. |

### Example Input

```json
{
"raw_chunk": "<div class=\"container\">\n  <h1>æ ‡é¢˜æ–‡æœ¬</h1>\n  <p>æ­£æ–‡æ®µè½ï¼ŒåŒ…æ‹¬ç‰¹æ®Šç¬¦å·ï¼Œä¾‹å¦‚â€œå¼¯å¼•å·â€ã€â€“ç ´æŠ˜å·ç­‰</p>\n  <img src=\"example.jpg\" alt=\"ç¤ºæ„å›¾\">\n  <a href=\"...\">é“¾æ¥æ–‡æœ¬</a>\n  <pre><code>ä»£ç ç‰‡æ®µ</code></pre>\n</div>"
}
```

### Example Output

```json
{
"raw_chunk": "<div class=\"container\">\n  <h1>æ ‡é¢˜æ–‡æœ¬</h1>\n  <p>æ­£æ–‡æ®µè½ï¼ŒåŒ…æ‹¬ç‰¹æ®Šç¬¦å·ï¼Œä¾‹å¦‚â€œå¼¯å¼•å·â€ã€â€“ç ´æŠ˜å·ç­‰</p>\n  <img src=\"example.jpg\" alt=\"ç¤ºæ„å›¾\">\n  <a href=\"...\">é“¾æ¥æ–‡æœ¬</a>\n  <pre><code>ä»£ç ç‰‡æ®µ</code></pre>\n</div>",
"cleaned_chunk": "æ ‡é¢˜æ–‡æœ¬\n\næ­£æ–‡æ®µè½ï¼ŒåŒ…æ‹¬ç‰¹æ®Šç¬¦å·ï¼Œä¾‹å¦‚\"ç›´å¼•å·\"ã€-ç ´æŠ˜å·ç­‰\n\n[Image: ç¤ºæ„å›¾ example.jpg]\n\né“¾æ¥æ–‡æœ¬\n\n<code>ä»£ç ç‰‡æ®µ</code>"
}
```
