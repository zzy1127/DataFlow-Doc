import{_ as i,c as s,b as e,o as a}from"./app-BqDkFDvD.js";const l={};function h(n,t){return a(),s("div",null,t[0]||(t[0]=[e('<h2 id="📘-概述" tabindex="-1"><a class="header-anchor" href="#📘-概述"><span>📘 概述</span></a></h2><p><a href="https://github.com/OpenDCAI/DataFlow/blob/main/dataflow/operators/filter/debertav3_filter.py" target="_blank" rel="noopener noreferrer">DebertaV3Filter</a> 是一个基于 Deberta V3 模型的文本质量过滤算子。它利用 Nvidia 的质量分类器对输入文本进行评分（如 &#39;High&#39;, &#39;Medium&#39;, &#39;Low&#39;），并根据预设的允许分数列表来筛选数据，保留符合质量要求的样本。</p><h2 id="init-函数" tabindex="-1"><a class="header-anchor" href="#init-函数"><span>__init__函数</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> allowed_scores </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> list</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Medium</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">High</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> model_name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nvidia/quality-classifier-deberta</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> model_cache_dir</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./dataflow_cache</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> device</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cuda</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> batch_size</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">16</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="init参数说明" tabindex="-1"><a class="header-anchor" href="#init参数说明"><span>init参数说明</span></a></h3><table><thead><tr><th style="text-align:left;">参数名</th><th style="text-align:left;">类型</th><th style="text-align:left;">默认值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>allowed_scores</strong></td><td style="text-align:left;">list</td><td style="text-align:left;"><code>[&#39;Medium&#39;, &#39;High&#39;]</code></td><td style="text-align:left;">允许通过的分数列表。</td></tr><tr><td style="text-align:left;"><strong>model_name</strong></td><td style="text-align:left;">str</td><td style="text-align:left;"><code>&#39;nvidia/quality-classifier-deberta&#39;</code></td><td style="text-align:left;">Deberta V3 质量分类器模型名称。</td></tr><tr><td style="text-align:left;"><strong>model_cache_dir</strong></td><td style="text-align:left;">str</td><td style="text-align:left;"><code>&#39;./dataflow_cache&#39;</code></td><td style="text-align:left;">模型缓存目录。</td></tr><tr><td style="text-align:left;"><strong>device</strong></td><td style="text-align:left;">str</td><td style="text-align:left;"><code>&#39;cuda&#39;</code></td><td style="text-align:left;">运行设备（例如 &#39;cuda&#39; 或 &#39;cpu&#39;）。</td></tr><tr><td style="text-align:left;"><strong>batch_size</strong></td><td style="text-align:left;">int</td><td style="text-align:left;"><code>16</code></td><td style="text-align:left;">批处理大小。</td></tr></tbody></table><h2 id="run函数" tabindex="-1"><a class="header-anchor" href="#run函数"><span>run函数</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DataFlowStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> input_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Debertav3Score</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>执行算子主逻辑，从存储中读取输入 DataFrame，对指定列进行质量评分，并根据 <code>allowed_scores</code> 过滤数据，最后将结果写回存储。</p><h4 id="参数" tabindex="-1"><a class="header-anchor" href="#参数"><span>参数</span></a></h4><table><thead><tr><th style="text-align:left;">名称</th><th style="text-align:left;">类型</th><th style="text-align:left;">默认值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>storage</strong></td><td style="text-align:left;">DataFlowStorage</td><td style="text-align:left;">必需</td><td style="text-align:left;">数据流存储实例，负责读取与写入数据。</td></tr><tr><td style="text-align:left;"><strong>input_key</strong></td><td style="text-align:left;">str</td><td style="text-align:left;">必需</td><td style="text-align:left;">输入列名，对应需要进行质量评估的文本字段。</td></tr><tr><td style="text-align:left;"><strong>output_key</strong></td><td style="text-align:left;">str</td><td style="text-align:left;"><code>&#39;Debertav3Score&#39;</code></td><td style="text-align:left;">输出列名，对应生成的质量分数字段。</td></tr></tbody></table><h2 id="🧠-示例用法" tabindex="-1"><a class="header-anchor" href="#🧠-示例用法"><span>🧠 示例用法</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="🧾-默认输出格式-output-format" tabindex="-1"><a class="header-anchor" href="#🧾-默认输出格式-output-format"><span>🧾 默认输出格式（Output Format）</span></a></h4><p>算子执行后，会在输入的 DataFrame 中增加一个由 <code>output_key</code> 指定的列，用于存放质量分数。最终输出的 DataFrame 只包含分数在 <code>allowed_scores</code> 列表中的行。</p><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">（输入 DataFrame 的原始字段）</td></tr><tr><td style="text-align:left;"><strong>Debertav3Score</strong> (或自定义的<code>output_key</code>)</td><td style="text-align:left;">str</td><td style="text-align:left;">模型生成的质量分数（例如 &#39;High&#39;, &#39;Medium&#39;, &#39;Low&#39;）。</td></tr></tbody></table>',16)]))}const r=i(l,[["render",h]]),k=JSON.parse('{"path":"/zh/api/operators/text_pt/filter/debertav3filter/","title":"DebertaV3Filter","lang":"zh-CN","frontmatter":{"title":"DebertaV3Filter","createTime":"2025/10/09 17:09:04","permalink":"/zh/api/operators/text_pt/filter/debertav3filter/"},"readingTime":{"minutes":1.35,"words":405},"git":{"createdTime":1760001305000,"updatedTime":1760001305000,"contributors":[{"name":"Hao Liang","username":"","email":"hao.liang@stu.pku.edu.cn","commits":1,"avatar":"https://gravatar.com/avatar/105bae3e8661728b9f2f5440992b04f5f28459b66a049d09b52213ce1438f6bc?d=retro"}]},"filePathRelative":"zh/notes/api/operators/text_pt/filter/DebertaV3Filter.md","headers":[]}');export{r as comp,k as data};
